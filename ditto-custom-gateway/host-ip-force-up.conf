# Host-IP Based Force-Up Configuration
# Uses your host machine IP for stable networking

include "ditto-gateway"

ditto {
  gateway {
    bootstrap {
      force-up = true
      force-up = ${?DITTO_GATEWAY_BOOTSTRAP_FORCE_UP}
    }
    
    http {
      hostname = "0.0.0.0"
      port = 8080
    }
    
    authentication {
      devops {
        password = "devops"
      }
      status {
        password = "status"
      }
    }
  }
}

pekko {
  actor {
    provider = "cluster"
  }
  
  cluster {
    # Use host machine IP with container port for seed node
    seed-nodes = ["pekko://ditto-cluster@192.168.0.6:2553"]
    
    min-nr-of-members = 1
    roles = ["gateway"]
    
    # Fast failure detection
    failure-detector {
      acceptable-heartbeat-pause = 3s
      heartbeat-interval = 1s
    }
    
    # Auto-down for single-node
    auto-down-unreachable-after = 5s
  }
  
  remote.artery {
    canonical {
      # Use host IP for external addressing
      hostname = "192.168.0.6"
      port = 2553
    }
    bind {
      hostname = "0.0.0.0"
      port = 2551
    }
  }
  
  # Disable cluster bootstrap
  management {
    http {
      hostname = "0.0.0.0"
      port = 8558
    }
    
    cluster.bootstrap {
      contact-point-discovery {
        discovery-method = "disabled"
      }
    }
  }
  
  http {
    server.bind-timeout = 5s
  }
  
  loggers = ["org.apache.pekko.event.slf4j.Slf4jLogger"]
  loglevel = "INFO"
}